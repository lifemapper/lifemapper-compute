#!/bin/bash 
#
# Update @LMHOME@/config/config.ini file with correct ip info  
#
usage () 
{
    echo "Usage: $0"
    echo "This script copies maintenance scripts in @LMHOME@/LmCompute/scripts " 
    echo "and @LMHOME@/config/ directories to the cron.daily directory and "
    echo "sets execute permissions."
}

### define varibles
setDefaults () {
    # script to seed layers
    CRON_DIR=/etc/cron.daily/
    TASK_DIR=@LMHOME@/LmCompute/scripts/
    LOG=/tmp/`/bin/basename $0`.log
    touch $LOG
    TimeStamp "# Start"
}

TimeStamp () {
    echo $1 `/bin/date` >> $LOG
}

# install cron jobs
installDailyTasks () {
    install @LMHOME@/config/securityUpdates.sh ${CRON_DIR}
    install ${TASK_DIR}/maintenance-aggregate-logs.sh  ${CRON_DIR}
    install ${TASK_DIR}/maintenance-cleanup-jobs-rocks.sh  ${CRON_DIR}
    install ${TASK_DIR}/maintenance-free-memory-rocks.sh  ${CRON_DIR}    
    echo "Installed tasks to ${CRON_DIR} ..." | tee -a $LOG
}

#### Main ####
if [ $# -ne 0 ]; then
    usage
    exit 0
fi 

setDefaults
installDailyTasks
TimeStamp "# End"
