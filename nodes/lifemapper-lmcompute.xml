<?xml version="1.0" standalone="no"?>

<kickstart>


	<description>
	Lifemapper roll (lmcompute part)
	Frontend install. Create user, exported dirs
	</description>

	<copyright>
	Copyright (c) 2000 - 2012 The Regents of the University of California.
	All rights reserved. Rocks(r) v5.5/v6.0 www.rocksclusters.org
	
	</copyright>

	<changelog>
	$Log$
	</changelog>

	<package>roll-lifemapper-usersguide</package>

<post>
yum --enablerepo base install screen

/usr/sbin/groupadd -g 502 lmwriter
rocks sync users

mkdir -p /state/partition1/lm
mkdir -p /state/partition1/lm/jobs
mkdir -p /state/partition1/lm/metrics
mkdir -p /state/partition1/lm/temp
mkdir -p /state/partition1/lm/logs
mkdir -p /state/partition1/lm/data/layers
mkdir -p /state/partition1/lm/tests/jobs
/bin/cp -p -r /opt/lifemapper/lm/tests/* /state/partition1/lm/tests
chgrp -R lmwriter /state/partition1/lm
chmod -R g+ws /state/partition1/lm

<file name="/etc/auto.share" mode="append">
lm &Kickstart_PrivateHostname;:/export/&amp;
</file>

/etc/init.d/autofs restart
/opt/rocks/bin/rocks sync users
/opt/rocks/bin/rocks run host compute "service autofs restart"

</post>

</kickstart>
